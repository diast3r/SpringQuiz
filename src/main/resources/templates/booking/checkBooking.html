<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
    <head>
        <title>통나무 펜션</title>
        <meta charset="utf-8">
        <!-- jquery -->
        <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
        <!-- bootstrap -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>

        <!-- datepicker -->
        <script src="https://code.jquery.com/ui/1.14.0/jquery-ui.js"></script>
        <link rel="stylesheet" href="https://code.jquery.com/ui/1.14.0/themes/base/jquery-ui.css">

        <!-- 사용자 스타일시트 -->
        <link rel="stylesheet" th:href="@{/css/booking.css}" type="text/css">
    </head>
    <body>
        <div id="wrap">
            <!-- 헤더 영역 -->
            <header class="d-flex justify-content-center align-items-center">
                <h1 class="display-4">통나무 펜션</h1>
            </header>

            <!-- 섹션 영역 -->
            <section class="contents bg-warning">
                <nav class="d-flex align-items-center font-weight-bold">
                    <ul class="nav nav-fill w-100">
                        <li class="nav-item"><a href="/booking/check-booking-view" class="nav-link">펜션소개</a></li>
                        <li class="nav-item"><a href="#" class="nav-link">객실보기</a></li>
                        <li class="nav-item"><a href="/booking/make-booking-view" class="nav-link">예약하기</a></li>
                        <li class="nav-item"><a href="/booking/booking-list-view" class="nav-link">예약목록</a></li>
                    </ul>
                </nav>
                <div class="mainImg bg-dark">
                    <img id="bannerImg"
                        src="/img/booking/test06_banner1.jpg"
                        alt="메인 배너 사진"
                        class="w-100" 
                    >
                </div>

                <!-- 사진 아래 영역 -->
                <section class="module-box d-flex justify-content-between">
                    <!-- 실시간 예약하기 -->
                    <div class="reserve-module col-4 d-flex justify-content-center align-items-center">
                        <div id="reserveText">
                            <a href="#">
                                <div class="display-4">실시간</div>
                                <div class="display-4">예약하기</div>
                            </a>
                        </div>
                    </div>

                    <!-- 예약확인 영역 -->
                    <div class="check-module col-4">
                        <!-- 예약확인 텍스트, 회원여부 선택 -->
                        <div class="check-module-header pb-2 d-flex align-items-end">
                            <h2 class="mb-0">예약 확인</h2>
                            <div class="ml-3">
                                <label class="mb-0">회원 <input type="radio" name="memberCheck" value="member" checked></label>
                                <label class="ml-3 mb-0">비회원 <input type="radio" name="memberCheck" value="nonMember"></label>
                            </div>
                        </div>

                        <!-- 회원용 입력란 -->
                        <div id="memberInput" class="">
                            <div class="d-flex check-module-input">
                                <div class="col-3 p-0 d-flex justify-content-end align-items-center">
                                    아이디
                                </div>
                                <div class="col-9 d-flex align-items-center">
                                    <input id="userId" type="text" class="form-control form-control-lg">
                                </div>
                            </div>
                            <div class="d-flex check-module-input">
                                <div class="col-3 p-0 d-flex justify-content-end align-items-center">
                                    비밀번호
                                </div>
                                <div class="col-9 d-flex align-items-center">
                                    <input id="password" type="password" class="form-control form-control-lg">
                                </div>
                            </div>
                        </div>

                        <!-- 비회원용 입력란 -->
                        <div id="nonMemberInput" class="d-none">
                            <div class="d-flex check-module-input">
                                <div class="col-3 p-0 d-flex justify-content-end align-items-center">
                                    이름
                                </div>
                                <div class="col-9 d-flex align-items-center">
                                    <input id="name" type="text" class="form-control form-control-lg">
                                </div>
                            </div>
                            <div class="d-flex check-module-input">
                                <div class="col-3 p-0 d-flex justify-content-end align-items-center">
                                    전화번호
                                </div>
                                <div class="col-9 d-flex align-items-center">
                                    <input id="phoneNumber" type="text" class="form-control form-control-lg">
                                </div>
                            </div>
                            <div class="d-flex check-module-input">
                                <div class="col-3 p-0 d-flex justify-content-end align-items-center">
                                    날짜
                                </div>
                                <div class="col-9 d-flex align-items-center">
                                    <input id="date" type="text" class="form-control form-control-lg">
                                </div>
                            </div>
                        </div>

                        <!-- 조회하기 버튼 -->
                        <div class="col-12 d-flex justify-content-end mb-2">
                            <button id="searchBtn" class="btn btn-lg btn-success">조회하기</button>
                        </div>
                    </div>

                    <!-- 문의전화 영역 -->
                    <div class="call-module col-4 d-flex justify-content-center align-items-center">
                        <div>
                            <h2>예약문의:</h2>
                            <div>010-</div>
                            <div>0000-1111</div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- footer 영역 -->
            <footer class="bg-light">
                <div id="info" class=" pt-2 pl-4">
                    <div>제주특별자치도 제주시 애월읍</div>
                    <div>사업자등록번호: 111-22-255222 / 농어촌 민박사업자지정 / 대표:김통목</div>
                    <div>Copyright <span class="year-text">2019</span> tongnamu. All right reserved.</div>
                </div>
            </footer>
        </div>

        <script>
            $(document).ready(function() {
                // 2-1) 회원/비회원 변경
                $("input[name=memberCheck]").on("change", function() {
                    if ($(this).val() == "member") { // this는 이벤트의 대상인 요소를 가져옴.(memberCheck의 요소 두 개 중 change 이벤트 일어난 항목.)
                        $("#memberInput").removeClass("d-none");
                        $("#nonMemberInput").addClass("d-none");
                    } else {
                        $("#nonMemberInput").removeClass("d-none");
                        $("#memberInput").addClass("d-none");
                    }
                })

                // 2-2) 날짜 선택 - datepicker
                $("#date").datepicker({
                    dateFormat:"yy년 m월 d일",
                    minDate: "0",
                });

                // 3. 조회버튼 유효성 검사
                $("#searchBtn").on("click", function() {
                    let memberCheck = $("input[name=memberCheck]:checked").val();
                    // 회원
                    if (memberCheck == "member") {
                        let id = $("#userId").val().trim();
                        let password = $("#password").val();
                        if (id == "") {
                            alert("아이디를 입력하세요");
                            return;
                        }
                        if (password.length < 1) {
                            alert("비밀번호를 입력하세요");
                            return;
                        }

                    // 비회원
                    } else {
                        let name = $("#name").val().trim();
                        let phoneNumber = $("#phoneNumber").val().trim();
                        let date = $("#date").val();
                        if (!name) {
                            alert("이름을 입력하세요");
                            return;
                        }
                        if (!phoneNumber) {
                            alert("전화번호를 입력하세요");
                            return;
                        }
                        if (phoneNumber.startsWith("010") == false) {
                            alert("010으로 시작하는 번호만 입력 가능합니다.");
                            return;
                        }
                        if (!date) {
                            alert("날짜를 입력하세요")
                            return;
                        }
                    }

                    // 유효성 검사 통과
                    alert("조회 가능");
                })
                
                // 배너 이미지 순환
                let rotateBannerImg;
                let imgIndex = 0;
                let imgSrc = [
                    "/img/booking/test06_banner1.jpg",
                    "/img/booking/test06_banner2.jpg",
                    "/img/booking/test06_banner3.jpg",
                    "/img/booking/test06_banner4.jpg",
                ]
                
                // 순환 시작 함수
                function startRotate() {
                    rotateBannerImg = setInterval(function () {
                        $("#bannerImg").attr("src", imgSrc[++imgIndex])
                        if (imgIndex == imgSrc.length - 1) {
                            imgIndex = -1;
                        }
                    }, 3000);
                }
                
                // 순환 종료 함수
                function stopRotate() {
                    clearInterval(rotateBannerImg);
                }
                
                
                startRotate();
                $("#bannerImg").on("mouseout", function() {
                    startRotate();
                })
                
                $("#bannerImg").on("mouseover", function() {
                    stopRotate();
                })
            })
        </script>
    </body>
</html>